# Link Server Protocol

Author: qians

Date: 2023/4/25

Version: 0.0.1

## LinkProtocol

本协议只用于Link Infra的行为, 与业务逻辑无关. 在原则上, 本协议应该尽可能精简和通用.
并为将来的压缩, 加密等行为留出空间.

### 私聊

| 参数名  | 参数类型 | 说明     | 是否必填 |
| ------- | -------- | -------- | -------- |
| recv_id | String   | 接收者id | 是       |
| content | String   | 发送内容 | 是       |

- example

    ```json
    ["recvxx", "message content"]
    ```

### 群聊

| 参数名     | 参数类型      | 说明         | 是否必填 |
| ---------- | ------------- | ------------ | -------- |
| chat_id    | String        | 目的群id     | 是       |
| exclusions | Vec\<String\> | 排除用户列表 | 是(可空) |
| content    | String        | 发送内容     | 是       |

- example

    ```json
    ["recvxx", ["uu_1"], "message content"]
    ```

## Proxy

Proxy对外提供HTTP接口供Business Service调用并将数据推送给对应TCP Service.

### Push

请求地址: post /message

- Request

  | 字段     | 说明     | 类型         | 备注       | 是否必填 |
  | -------- | -------- | ------------ | ---------- | -------- |
  | protocol | 协议报文 | LinkProtocol | 按JSON即可 | 是       |

  - 示例
  
    ```json
    ["recvxx", ["uu_1"], "message content"]
    ```

- Response

  返回参数：

  | 字段   | 说明   | 类型 | 备注                   | 是否必填 |
  | ------ | ------ | ---- | ---------------------- | -------- |
  | status | 状态码 | Int  | 成功: 200, 已推入Kafka | 是       |

  无返回值
